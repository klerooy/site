import{_ as f,h as C,o as h,b as r,c as i,d as t,F as w,r as x,l as S,v as L,u as n,g as d,t as a,f as m,w as v,R as y,i as R,q as V,e as U}from"./index-D76P8q1G.js";const q={class:"section"},M={class:"container"},$={key:0,class:"cart-layout"},D={class:"card cart-items"},I=["src","alt"],N={class:"qty-controls"},B=["onClick"],F=["onClick"],P=["onClick"],T={class:"card cart-summary"},E={class:"promo-row"},j={class:"delivery"},z=["checked"],A=["checked"],G={class:"summary-line"},H={class:"summary-line"},J={class:"summary-line"},K={class:"summary-line total"},O={key:0,class:"notice"},Q={key:1,class:"card empty"},W={__name:"CartView",setup(X){const s=C(),u=U(""),c=V(()=>{var l;return((l=s.cart)==null?void 0:l.detailed_items)||[]});async function _(l){await s.updateCartItem(l.product.id,l.qty+1)}async function k(l){const o=Math.max(1,l.qty-1);await s.updateCartItem(l.product.id,o)}async function b(l){await s.removeCartItem(l.product.id)}async function g(){if(u.value.trim())try{await s.applyPromo(u.value),u.value=""}catch{}}return h(async()=>{await s.fetchCart()}),(l,o)=>(r(),i("section",q,[t("div",M,[o[14]||(o[14]=t("h1",{class:"title"},"Корзина",-1)),o[15]||(o[15]=t("p",{class:"subtitle"},"Проверьте состав заказа, промокод и способ доставки.",-1)),c.value.length?(r(),i("div",$,[t("article",D,[(r(!0),i(w,null,x(c.value,e=>(r(),i("div",{class:"cart-line",key:e.product.id},[t("img",{src:e.product.images[0],alt:e.product.name},null,8,I),t("div",null,[t("h3",null,a(e.product.name),1),t("p",null,a(e.product.brand),1),t("strong",null,a(e.line_total.toLocaleString("ru-RU"))+" ₽",1)]),t("div",N,[t("button",{type:"button",onClick:p=>k(e)},"−",8,B),t("span",null,a(e.qty),1),t("button",{type:"button",onClick:p=>_(e)},"+",8,F)]),t("button",{type:"button",class:"remove",onClick:p=>b(e)},"Удалить",8,P)]))),128))]),t("aside",T,[o[10]||(o[10]=t("h2",null,"Ваш заказ",-1)),t("div",E,[S(t("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>u.value=e),class:"input",type:"text",placeholder:"Промокод"},null,512),[[L,u.value]]),t("button",{class:"btn btn-soft",type:"button",onClick:g},"Применить")]),t("div",j,[t("label",null,[t("input",{type:"radio",value:"courier",checked:n(s).cart.delivery_method==="courier",onChange:o[1]||(o[1]=e=>n(s).setDeliveryMethod("courier"))},null,40,z),o[3]||(o[3]=d(" Курьер ",-1))]),t("label",null,[t("input",{type:"radio",value:"pickup",checked:n(s).cart.delivery_method==="pickup",onChange:o[2]||(o[2]=e=>n(s).setDeliveryMethod("pickup"))},null,40,A),o[4]||(o[4]=d(" Самовывоз ",-1))])]),t("div",G,[o[5]||(o[5]=t("span",null,"Товары",-1)),t("strong",null,a(n(s).cart.subtotal.toLocaleString("ru-RU"))+" ₽",1)]),t("div",H,[o[6]||(o[6]=t("span",null,"Скидка",-1)),t("strong",null,"-"+a(n(s).cart.discount.toLocaleString("ru-RU"))+" ₽",1)]),t("div",J,[o[7]||(o[7]=t("span",null,"Доставка",-1)),t("strong",null,a(n(s).cart.delivery_cost.toLocaleString("ru-RU"))+" ₽",1)]),t("div",K,[o[8]||(o[8]=t("span",null,"Итого",-1)),t("strong",null,a(n(s).cart.total.toLocaleString("ru-RU"))+" ₽",1)]),m(n(y),{class:"btn btn-primary",to:"/checkout"},{default:v(()=>[...o[9]||(o[9]=[d("Оформить заказ",-1)])]),_:1}),n(s).error?(r(),i("p",O,a(n(s).error),1)):R("",!0)])])):(r(),i("div",Q,[o[12]||(o[12]=t("h3",null,"Корзина пока пустая",-1)),o[13]||(o[13]=t("p",null,"Добавьте товары из каталога, и они появятся здесь.",-1)),m(n(y),{class:"btn btn-primary",to:"/catalog"},{default:v(()=>[...o[11]||(o[11]=[d("Перейти в каталог",-1)])]),_:1})]))])]))}},Z=f(W,[["__scopeId","data-v-4a09d2f4"]]);export{Z as default};
